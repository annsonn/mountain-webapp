<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/polymerfire/polymerfire.html">
<link rel="import" href="../bower_components/app-storage/app-indexeddb-mirror/app-indexeddb-mirror.html">

<dom-module id="mountain-data">
    <template>

        <firebase-query
                id="query"
                path="[[userLocation]]"
                data="{{data}}">
        </firebase-query>

        <app-indexeddb-mirror
                session="[[uid]]"
                key="mountain"
                data="{{data}}"
                persisted-data="{{trainingData}}">
        </app-indexeddb-mirror>

        <firebase-document
                path="[[userLocation]]"
                data="{{trainingData}}">
        </firebase-document>

    </template>

    <script>
        (function() {
            'use strict';

            Polymer({
                is: 'mountain-data',

                properties: {
                    user: {
                        notify: true,
                        observer: '_userUpdated'
                    },
                    trainingData: {
                        type: Object,
                        observer: '_dataChanged'
                    }
                },

                _userUpdated: function (user) {
                    if (user) {
                        this.userLocation = '/users/' + user.uid;
                        console.log(this.userLocation);
                    }
                },

                _dataChanged: function (newData, oldData) {
                    console.log('dataChanged', newData, oldData);
                    //this.$.document.save(this.notesPath)
                }
            });
        })();
    </script>
</dom-module>
